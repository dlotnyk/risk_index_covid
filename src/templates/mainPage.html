<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
        integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw=="
        crossorigin="anonymous" />
    <script src='static/Chart.min.js'></script>

    <title>Risk index</title>
</head>

<body style="background-color: #d9d9d9;">
    <div class="container">
        <div class="row-1">
            <h3 class="text-center" style="padding-top: 3rem"><b>Calculation Risk Index For Bussines Purposes</b></h3>
        </div>

        <div class="row">
            <h5 class="text-left" style="padding-top: 3rem; color:#262626bd;"> <b>Contact Tracing Strategy</b> - a
                number of infected persons covered by tests for selected country.</h5>
        </div>

        <div class="row" style="margin-top: 3rem">
            <div class="input-group col">
                <select class="form-control" id="inputState" style="background-color: #e6e6e6"
                    placeholder="Choose country ...">
                    <option selected>Choose country ...</option>
                    <option value="AFG">AFG - Afghanistan</option>
                    <option value="AND">AND - Andorra</option>
                    <option value="ARE">ARE - United Arab Emirates</option>
                    <option value="ARG">ARG - Argentina</option>
                    <option value="AUS">AUS - Australia</option>
                    <option value="AUT">AUT - Austria</option>
                    <option value="BEL">BEL - Belgium</option>
                    <option value="BGR">BGR - Bulgaria</option>
                    <option value="BHS">BHS - Bahamas</option>
                    <option value="BIH">BGR - Bosnia and Herzegovina</option>
                    <option value="CAN">CAN - Canada</option>
                    <option value="BGR">CHE - Switzerland</option>
                    <option value="CHN">CHN - China</option>
                    <option value="CZE">CZE - Czechia</option>
                    <option value="DEU">DEU - Germany</option>
                    <option value="DNK">DNK - Denmark</option>
                    <option value="EGY">EGY - Egypt</option>
                    <option value="ESP">ESP - Spain</option>
                    <option value="EST">EST - Estonia</option>
                    <option value="FIN">FIN - Finland</option>
                    <option value="FJI">FJI - Fiji</option>
                    <option value="FRA">FRA - France</option>
                    <option value="GBR">GBR - United Kingdom of Great Britain and Northern Ireland</option>
                    <option value="HRV">HRV - Croatia</option>
                    <option value="HUN">HUN - Hungary</option>
                    <option value="IND">IND - India</option>
                    <option value="ITA">ITA - Italy</option>
                    <option value="LIE">LIE - Liechtenstein</option>
                    <option value="LKA">LKA - Sri Lanka</option>
                    <option value="LTU">LTU - Lithuania</option>
                    <option value="LUX">LUX - Luxembourg</option>
                    <option value="LVA">LVA - Latvia</option>
                    <option value="MDV">MDV - Maldives</option>
                    <option value="NLD">NLD - Netherlands</option>
                    <option value="NOR">NOR - Norway</option>
                    <option value="PER">PER - Peru</option>
                    <option value="PHL">PHL - Philippines</option>
                    <option value="POL">POL - Poland</option>
                    <option value="PRT">PRT - Portugal</option>
                    <option value="ROU">ROU - Romania</option>
                    <option value="RUS">RUS - Russian Federation</option>
                    <option value="SVK">SVK - Slovakia</option>
                    <option value="SVN">SVN - Slovenia</option>
                    <option value="SWE">SWE - Sweden</option>
                    <option value="UKR">UKR - Ukraine</option>
                    <option value="USA">USA - United States of America</option>

                </select>
            </div>
            <div class="input-daterange input-group col-4" id="datepicker">
                <input type="text" class="input form-control" name="start" id="startDate"
                    style="background-color: #e6e6e6" placeholder="Choose start date" />
                <span class="input-group-addon"
                    style="padding-left: 0.5rem; padding-right: 0.5rem; padding-top: 0.5rem; background-color:#d9d9d9 ">
                    <b>to</b></span>
                <input type="text" class="input form-control" name="end" id="endDate" style="background-color:#e6e6e6"
                    placeholder="Choose end date" />
            </div>

            <div class="input-group col">
                <select class="form-control" id="inputContactStrategy" style="background-color: #e6e6e6"
                    placeholder="Contact Strategy">
                    <option selected>Contact Tracing Strategy ...</option>
                    <option value="20">20 %</option>
                    <option value="25">25 %</option>
                    <option value="30">30 %</option>
                    <option value="35">35 %</option>
                    <option value="40">40 %</option>
                    <option value="45">45 %</option>
                    <option value="50">50 %</option>
                    <option value="55">55 %</option>
                    <option value="60">60 %</option>
                    <option value="65">65 %</option>
                    <option value="70">70 %</option>
                    <option value="75">75 %</option>
                    <option value="80">80 %</option>
                    <option value="85">85 %</option>
                    <option value="90">90 %</option>
                    <option value="95">95 %</option>
                    <option value="100">100 %</option>
                </select>
            </div>

            <div class="col-2">
                <button type="button" class="btn btn-secondary btn-block" id="calculate-btn">Calculate</button>
            </div>


        </div>
        <div id="our_charts">
            <div class="row">
                <div class="col-6" id="myChartDiv">
                </div>
                <div class="col">
                    <div class="row"></div>
                    <div class="row">
                        <div class="col-5" id="myChartDiv2">
                        </div>
                    </div>
                    <div class="row"></div>
                </div>
                
            </div>
            <div class="row">
                
                <div class="col-5" id="myChartDiv3">
                </div>
                <div class="col-2"></div>
                <div class="col-5" id="myChartDiv4">
                </div>
            </div>
        </div>

        <div class="row" style="margin-top: 3rem; color:#262626bd;">
            <h4 class="text-center" style="padding-top: 3rem"><b>The project is designed by Dmytro Lotnyk and Veronika Haskova </b></h4>
        </div>

        <div class="row" style="margin-top: 2rem; color:#262626bd;">
            <footer>
                <p><b>Our risk index calculations are based on: </b></p>
                <ul>
                    <li>reproducion number - described in the <a href="https://www.thelancet.com/journals/lanpub/article/PIIS2468-2667(20)30157-2/fulltext?fbclid=IwAR0bzrGXFdN5DBYTN8JpjLczNRt0MjXrhqxNK3mMj_FQ-lqNWdHnwUy1Nmk">paper</a>
                    </li>
                    <li>stringency index - obtained by <a href="https://covidtracker.bsg.ox.ac.uk/about-api">API</a>
                    </li>
                </ul>
            </footer>
        </div>

    </div>
    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.js"
        integrity="sha256-DrT5NfxfbHvMHux31Lkhxg42LY6of8TaYyK50jnxRnM=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
        integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
        integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
        crossorigin="anonymous"></script>

    <script>
        Chart.defaults.global.responsive = true;
        $('.input-daterange').datepicker({
            format: "yyyy-mm-dd",
            startDate: "2020-01-30",
            endDate: "1w",
            maxViewMode: 1,
            todayBtn: "linked",
            orientation: "bottom left",
            todayHighlight: true
        });

        $(function () {
            $('#calculate-btn').on('click', function (e) {
                e.preventDefault()

                if ($("#inputState").val() === 'Choose country ...' || $("#startDate").val() === '' || $("#endDate").val() === '' || $("#inputContactStrategy").val() === 'Contact Tracing Strategy ...') {
                    alert('All input fields are required! Check your inputs, please.');
                } else {
                    if ($('#myChartDiv') && $('#myChartDiv2') && $('#myChartDiv3') && $('#myChartDiv4')) {
                        $('#myChartDiv').empty();
                        $('#myChartDiv2').empty();
                        $('#myChartDiv3').empty();
                        $('#myChartDiv4').empty();
                    }

                    $.getJSON('/simple_chart', {
                        state: $("#inputState").val(),
                        start_date: $("#startDate").val(),
                        end_date: $("#endDate").val(),
                        contact_strategy: $("#inputContactStrategy").val()
                    },
                        function (data) {
                            let chartData = {
                                labels: data.dates,
                                datasets: [{
                                    label: "Stringency",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(75,192,192,0.4)",
                                    borderColor: "rgba(75,192,192,1)",
                                    borderCapStyle: 'butt',
                                    borderDash: [],
                                    borderDashOffset: 0.0,
                                    borderJoinStyle: 'miter',
                                    pointBorderColor: "rgba(75,192,192,1)",
                                    pointBackgroundColor: "#fff",
                                    pointBorderWidth: 1,
                                    pointHoverRadius: 5,
                                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                                    pointHoverBorderColor: "rgba(220,220,220,1)",
                                    pointHoverBorderWidth: 2,
                                    pointRadius: 1,
                                    pointHitRadius: 10,
                                    data: data.si,
                                    spanGaps: false
                                }]
                            }

                            let canvas1 = $('<canvas id="myChart" width="700" height="500"></canvas>');
                            let caption1 = $('<p id="caption1"></p>');
                            caption1.text('Risk - ');
                            $('#myChartDiv').append(canvas1);
                            $('#myChartDiv').append(caption1);

                            let canvas2 = $('<canvas id="myChart2" width="600" height="400"></canvas>');
                            let caption2 = $('<p id="caption2"></p>');
                            caption2.text('Stringency - ');
                            $('#myChartDiv2').append(canvas2);
                            $('#myChartDiv2').append(caption2);

                            let canvas3 = $('<canvas id="myChart3" width="600" height="400"></canvas>');
                            let caption3 = $('<p id="caption3"></p>');
                            caption3.text('Cases - ');
                            $('#myChartDiv3').append(canvas3);
                            $('#myChartDiv3').append(caption3);

                            let canvas4 = $('<canvas id="myChart4" width="600" height="400"></canvas>');
                            let caption4 = $('<p id="caption4"></p>');
                            caption4.text('Cases in logarithmic scale - ');
                            $('#myChartDiv4').append(canvas4);
                            $('#myChartDiv4').append(caption4);


                            // get chart canvas
                            let ctx = document.getElementById("myChart").getContext("2d");
                            // second chart

                            let chartData2 = {
                                labels: data.dates,
                                datasets: [{
                                    label: "Risk",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(0, 102, 0, 0.4)",
                                    borderColor: "rgba(0, 102, 0, 1)",
                                    borderCapStyle: 'butt',
                                    borderDash: [],
                                    borderDashOffset: 0.0,
                                    borderJoinStyle: 'miter',
                                    pointBorderColor: "rgba(0, 102, 0, 1)",
                                    pointBackgroundColor: "rgba(0, 102, 0, 1)",
                                    pointBorderWidth: 1,
                                    pointHoverRadius: 5,
                                    pointHoverBackgroundColor: "rgba(0, 102, 0, 1)",
                                    pointHoverBorderColor: "rgba(220,220,220,1)",
                                    pointHoverBorderWidth: 2,
                                    pointRadius: 2,
                                    pointHitRadius: 10,
                                    data: data.ri,
                                    spanGaps: false
                                }]
                            }

                            // get chart canvas
                            let ctx1 = document.getElementById("myChart2").getContext("2d");

                            // create the chart using the chart canvas
                            let myChart2 = new Chart(ctx1, {
                                type: 'line',
                                data: chartData,
                            });

                            let myChart = new Chart(ctx, {
                                type: 'line',
                                data: chartData2,
                            });
                            // third chart

                            let chartData3 = {
                                labels: data.dates,
                                datasets: [{
                                    label: "Cases",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(75,192,192,0.4)",
                                    borderColor: "rgba(75,192,192,1)",
                                    borderCapStyle: 'butt',
                                    borderDash: [],
                                    borderDashOffset: 0.0,
                                    borderJoinStyle: 'miter',
                                    pointBorderColor: "rgba(75,192,192,1)",
                                    pointBackgroundColor: "#fff",
                                    pointBorderWidth: 1,
                                    pointHoverRadius: 5,
                                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                                    pointHoverBorderColor: "rgba(220,220,220,1)",
                                    pointHoverBorderWidth: 2,
                                    pointRadius: 1,
                                    pointHitRadius: 10,
                                    data: data.cases,
                                    spanGaps: false
                                }]
                            }

                            // get chart canvas
                            let ctx2 = document.getElementById("myChart3").getContext("2d");

                            // create the chart using the chart canvas
                            let myChart3 = new Chart(ctx2, {
                                type: 'line',
                                data: chartData3,
                            });
                            // fourth chart

                            let chartData4 = {
                                labels: data.dates,
                                datasets: [{
                                    label: "Log Cases",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(75,192,192,0.4)",
                                    borderColor: "rgba(75,192,192,1)",
                                    borderCapStyle: 'butt',
                                    borderDash: [],
                                    borderDashOffset: 0.0,
                                    borderJoinStyle: 'miter',
                                    pointBorderColor: "rgba(75,192,192,1)",
                                    pointBackgroundColor: "#fff",
                                    pointBorderWidth: 1,
                                    pointHoverRadius: 5,
                                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                                    pointHoverBorderColor: "rgba(220,220,220,1)",
                                    pointHoverBorderWidth: 2,
                                    pointRadius: 1,
                                    pointHitRadius: 10,
                                    data: data.log_cases,
                                    spanGaps: false
                                }]
                            }

                            // get chart canvas
                            let ctx3 = document.getElementById("myChart4").getContext("2d");

                            // create the chart using the chart canvas
                            let myChart4 = new Chart(ctx3, {
                                type: 'line',
                                data: chartData4,
                            });
                            // do nothing
                        });
                    // let ourChart = $.get("/simple_chart")
                    // $("#our_charts").append(ourChart);
                    return false;
                }
            });
        });
    </script>

</body>

</html>